  
# 内存结构  
java虚拟机内存结构分为虚拟机内存和本地内存  
## 虚拟机内存  
虚拟机内存又分为栈(虚拟机栈和本地方法栈)、堆、程序计数器  
### 虚拟机栈
线程私有，主要存储栈帧。栈帧主要保存局部变量表、方法出口地址、操作数等信息  
当栈深度超过运行的深度时，抛出StackOverFlowError  
当内存不足，无法分配栈帧时，抛出OutOfMemoryError  
### 本地方法栈
线程私有，和虚拟机栈类似，主要是存储native方法的栈帧数据  
当栈深度超过运行的深度时，抛出StackOverFlowError  
当内存不足，无法分配栈帧时，抛出OutOfMemoryError  
### 程序计数器
线程私有，用于记录当前执行的字节码代码行号，若执行native方法，则为null  
且此处不会抛出OutOfMemoryError的异常  
### 堆
线程共有的内存区块，其主要分为运行时常量池、年轻代、老年代，其中默认条件下，年轻代和老年代为1:2的关系  
此处会抛出OutOfMemoryError的异常   
#### 年轻代
在复制算法下，年轻代分为eden区和两个survivor区，其大小比为8:1:1  
新生的对象将进入eden区，GC后，eden和from survivor区存活的对象进入to survivor区，且对象的存活计数器+1
#### 老年代
当新生成的对象大于阈值，则将会直接进入老年代  
当经过多次GC，存活计数器大于阈值（默认15）的对象也会被移入老年代  
当当前存活的对象中，某个年龄段的对象占比超过50%，则在GC时会将大于等于该年龄的对象移入老年代
## 本地内存  
本地内存分为应用使用的直接内存和替代之前方法区的元数据区  
此处会抛出OutOfMemoryError的异常
### 直接内存
除虚拟机和其他应用使用外的机器内存
### 元数据区 
替代之前的方法区，保存字类段和方法数据、构造函数和普通方法的字节码内容、还包括一些在类、实例、接口初始化时用到的特殊方法