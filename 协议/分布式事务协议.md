# 1 二阶段提交协议(2PC)
该提交协议分为准备阶段和提交阶段两个阶段，并且相比于普通的本地事务，其需要引入一个协调者以协调各个事务的执行
## 1.1 准备阶段
协调者要求各个参与者准备事务的提交，此时各个参与者执行本地事务，记录undo log，但并不提交事务，若执行失败，则回复协调者以触发全局的事务回退
## 1.2 提交阶段
协调者要求各个参与者提交事务，各个参与者进行commit操作以提交事务
## 1.3 问题
1. 性能问题，因为在执行事务途中，需要所有参与者同步阻塞，所以会对性能有影响
2. 可靠性问题，当协调者出现问题后，参与者将一直处于同步阻塞状态
3. 一致性问题，提交阶段中，协调者出现问题后，若有参与者commit失败，则无法进行回退从而导致数据的不一致
# 2 三阶段提交协议(3PC)
该提交协议在2PC协议的基础上，将准备阶段和提交阶段中的前者分为可提交阶段(canCommit)和准备提交阶段(preCommit)
## 2.1 canCommit 可提交阶段
此阶段协调者向所有参与者询问当前是否可以执行事务，若均可则进行下个阶段，反之则停止事务执行
## 2.2 preCommit 准备阶段
此阶段协调者要求所有参与者准备事务的提交，各个参与者受到请求后，进行本地事务的执行，记录undo log，但是不commit
## 2.3 commit阶段
协调者要求所有参与者进行commit操作，若commit失败，则利用undo log进行回退
# 3